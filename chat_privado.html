<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Rantikuy Empire - Business OS V11 SUPREMACY</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --p-green: #10b981;
            --p-vibrant: #22c55e;
            --p-gold: #f59e0b;
            --p-sky: #0ea5e9;
            --p-light: #f8fafc;
            --p-white: #ffffff;
            --p-dark: #0f172a;
            --p-slate: #64748b;
            --p-red: #ef4444;
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.1);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Plus Jakarta Sans', sans-serif; scrollbar-width: none; }
        *::-webkit-scrollbar { display: none; }

        body, html { margin: 0; padding: 0; height: 100%; width: 100%; background: var(--p-light); overflow: hidden; color: var(--p-dark); }

        .app-shell { display: flex; width: 300%; height: 100%; transition: transform 0.6s cubic-bezier(0.85, 0, 0.15, 1); }
        .pos-1 { transform: translateX(0%); }
        .pos-2 { transform: translateX(-33.333%); }
        .pos-3 { transform: translateX(-66.666%); }

        .screen { width: 33.333%; height: 100%; display: flex; flex-direction: column; background: var(--p-white); position: relative; overflow: hidden; }

        /* HEADER ELITE V11 */
        .header-premium { 
            padding: 25px 30px; 
            background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
            border-bottom: 2px solid #ecfdf5;
            display: flex; justify-content: space-between; align-items: center; 
            z-index: 100;
        }
        .header-premium h1 { margin: 0; font-size: 28px; font-weight: 800; letter-spacing: -1.5px; cursor: pointer; }
        .header-premium h1 span { color: var(--p-green); }
        .header-premium p { margin: 0; font-size: 10px; font-weight: 800; color: var(--p-slate); text-transform: uppercase; letter-spacing: 2px; }

        /* DASHBOARD - PANTALLA 1 */
        .dash-content { flex: 1; overflow-y: auto; padding: 20px; background: #fcfdfc; }
        .stat-card-main { 
            background: var(--p-dark); color: white; padding: 30px; border-radius: 40px; 
            margin-bottom: 25px; box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            position: relative; overflow: hidden;
        }
        .stat-card-main::after { content: ''; position: absolute; top: -50%; right: -50%; width: 200px; height: 200px; background: rgba(34,197,94,0.2); border-radius: 50%; }

        .grid-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px; }
        .menu-item { 
            background: white; padding: 25px; border-radius: 35px; border: 1px solid #f1f5f9;
            text-align: center; box-shadow: 0 10px 20px rgba(0,0,0,0.02); transition: 0.3s;
        }
        .menu-item:active { transform: scale(0.9); background: #f0fdf4; }
        .menu-item i { font-size: 30px; display: block; margin-bottom: 10px; }

        /* CHAT LIST */
        .biz-item { 
            background: white; padding: 20px; border-radius: 30px; 
            display: flex; align-items: center; gap: 18px; margin-bottom: 12px; 
            border: 1px solid #f1f5f9; box-shadow: 0 8px 20px rgba(0,0,0,0.02);
        }

        /* CHAT VIEW - PANTALLA 2 */
        .chat-bg { background: #f0f2f5 url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-blend-mode: overlay; }
        .chat-nav { background: white; padding: 15px 20px; display: flex; align-items: center; gap: 15px; border-bottom: 1px solid #eee; }

        .msg-container { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .bubble { max-width: 80%; padding: 16px 20px; border-radius: 25px; font-size: 15px; position: relative; }
        .mine { align-self: flex-end; background: var(--p-green); color: white; border-bottom-right-radius: 4px; }
        .theirs { align-self: flex-start; background: white; color: var(--p-dark); border-bottom-left-radius: 4px; }

        /* PANTALLA 3: CONFIGURACI√ìN Y M√âTRICAS */
        .settings-screen { background: #f8fafc; padding: 30px; }
        .config-row { background: white; padding: 20px; border-radius: 25px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }

        /* COMPONENTES PRO ACTIVADOS */
        .invoice-box { background: #1e293b; color: white; padding: 25px; border-radius: 30px; margin: 10px 0; border: 2px solid var(--p-green); }
        .map-box { background: white; border-radius: 30px; padding: 15px; border: 2px solid var(--p-green); margin: 10px 0; }
        
        /* BOTTOM NAV DOCK */
        .dock { 
            background: white; padding: 15px 10px calc(15px + var(--safe-bottom)); 
            border-top: 1px solid #f1f5f9; display: flex; justify-content: space-around;
        }
        .dock-btn { 
            border: none; background: none; font-size: 24px; color: #cbd5e1; 
            cursor: pointer; transition: 0.3s; width: 60px; height: 60px; border-radius: 20px;
        }
        .dock-btn.active { color: var(--p-green); background: #f0fdf4; }

        /* MODALES */
        .overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); backdrop-filter: blur(8px);
            z-index: 1000; display: none; justify-content: center; align-items: center; padding: 20px;
        }
        .modal { background: white; width: 100%; max-width: 400px; border-radius: 40px; padding: 35px; animation: pop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
        @keyframes pop { from { transform: scale(0.8); opacity: 0; } }

        /* ADMIN CONSOLE */
        #adminConsole { position: fixed; top:0; left:0; width:100%; height:100%; background:black; color:#0f0; font-family:monospace; padding:30px; z-index:9999; display:none; overflow-y:auto; }
    </style>
</head>
<body>

<div id="adminConsole">
    <h2>> RANTIKUY_CORE_V11_EMPIRE</h2>
    <hr>
    <div id="adminLog"></div>
    <button onclick="document.getElementById('adminConsole').style.display='none'" style="background:#0f0; border:none; padding:10px; margin-top:20px;">SALIR_ROOT</button>
</div>

<div class="app-shell" id="appShell">
    
    <div class="screen">
        <header class="header-premium">
            <div>
                <h1 onclick="adminTaps()">Rantikuy<span>.Biz</span></h1>
                <p>Nivel: Lider Supremo üëë</p>
            </div>
            <div style="text-align:right">
                <b style="font-size:22px;">S/ <span id="balance">4,520.00</span></b>
                <div style="color:var(--p-green); font-size:10px; font-weight:800;">ACTIVO HUANTA</div>
            </div>
        </header>

        <div class="dash-content">
            <div class="stat-card-main">
                <span style="font-size:12px; opacity:0.8; font-weight:800;">TOTAL VENTAS MES</span>
                <h2 style="font-size:40px; margin:10px 0;">S/ 12,840.00</h2>
                <div style="background:rgba(255,255,255,0.2); padding:10px 15px; border-radius:15px; display:inline-block; font-size:12px;">
                    üìà +15% desde ayer
                </div>
            </div>

            <div class="grid-menu">
                <div class="menu-item" onclick="openInventory()"><i>üì¶</i><b>Inventario</b></div>
                <div class="menu-item" onclick="openReports()"><i>üìä</i><b>Reportes</b></div>
                <div class="menu-item" onclick="openCatalog()"><i>üè∑Ô∏è</i><b>Cat√°logo</b></div>
                <div class="menu-item" onclick="openMapGeneral()"><i>üìç</i><b>Log√≠stica</b></div>
            </div>

            <b style="color:var(--p-slate); font-size:12px; padding-left:10px;">BANDEJA DE NEGOCIOS</b>
            <div id="inbox" style="margin-top:15px;"></div>
        </div>

        <nav class="dock">
            <button class="dock-btn active" onclick="navTo(1)">üè¢</button>
            <button class="dock-btn" onclick="navTo(2)">üí¨</button>
            <button class="dock-btn" onclick="navTo(3)">‚öôÔ∏è</button>
        </nav>
    </div>

    <div class="screen chat-bg">
        <nav class="chat-nav">
            <button onclick="navTo(1)" style="border:none; background:none; font-size:24px;">‚ùÆ</button>
            <div id="chatAvatar" style="width:45px; height:45px; background:var(--p-green); border-radius:15px; color:white; display:flex; align-items:center; justify-content:center; font-weight:800;">?</div>
            <div style="flex:1">
                <b id="chatName">Socio</b>
                <div style="font-size:10px; color:var(--p-green); font-weight:800;">NEGOCIACI√ìN ENCRIPTADA</div>
            </div>
            <button onclick="openSecurityInfo()" style="background:none; border:none; font-size:22px;">üõ°Ô∏è</button>
        </nav>

        <div id="msgFlow" class="msg-container"></div>

        <div style="background:white; padding:15px; display:flex; gap:10px; overflow-x:auto;">
            <button onclick="sendOfferModal()" style="background:var(--p-gold); color:white; border:none; padding:12px 20px; border-radius:20px; font-weight:800; white-space:nowrap;">üí∞ OFERTAR</button>
            <button onclick="sendMapModal()" style="background:var(--p-dark); color:white; border:none; padding:12px 20px; border-radius:20px; font-weight:800; white-space:nowrap;">üìç PUNTO</button>
            <button onclick="generateInvoice()" style="background:var(--p-green); color:white; border:none; padding:12px 20px; border-radius:20px; font-weight:800; white-space:nowrap;">üßæ FACTURA</button>
        </div>

        <div style="background:white; padding:15px 20px calc(20px + var(--safe-bottom)); display:flex; align-items:center; gap:10px; border-top:1px solid #eee;">
            <button onclick="pickFile()" style="background:#f1f5f9; border:none; width:50px; height:50px; border-radius:50%; font-size:20px;">üìé</button>
            <input type="text" id="userInput" placeholder="Escribe tu propuesta..." style="flex:1; border:none; background:#f1f5f9; padding:15px 25px; border-radius:30px; outline:none; font-weight:500;">
            <button onclick="processMessage()" style="background:var(--p-dark); color:white; border:none; width:55px; height:55px; border-radius:50%; font-size:20px;">üöÄ</button>
        </div>
    </div>

    <div class="screen settings-screen">
        <h2 style="font-size:32px; letter-spacing:-1px;">Configuraci√≥n</h2>
        <div style="display:flex; align-items:center; gap:20px; margin-bottom:30px; background:white; padding:20px; border-radius:30px;">
            <div style="width:70px; height:70px; background:var(--p-green); border-radius:25px; display:flex; align-items:center; justify-content:center; color:white; font-size:30px;">üëë</div>
            <div>
                <b style="font-size:20px;">Lider Supremo</b>
                <p style="margin:0; font-size:12px; color:var(--p-slate);">Admin ID: #HUA-2026</p>
            </div>
        </div>

        <div class="config-row"><span>Notificaciones de Trato</span><input type="checkbox" checked></div>
        <div class="config-row"><span>Modo Huanta Market</span><input type="checkbox" checked></div>
        <div class="config-row"><span>Encriptaci√≥n AES-256</span><b>ACTIVA</b></div>
        <div class="config-row" onclick="clearEmpireData()" style="color:var(--p-red);"><span>Eliminar rastro comercial</span><b>DEL</b></div>

        <button onclick="navTo(1)" style="width:100%; background:var(--p-dark); color:white; border:none; padding:20px; border-radius:25px; margin-top:30px; font-weight:800;">GUARDAR CAMBIOS</button>
    </div>

</div>

<div class="overlay" id="modalOffer">
    <div class="modal">
        <h2>Contraoferta</h2>
        <p>Establece un precio competitivo.</p>
        <div style="background:#f1f5f9; padding:20px; border-radius:25px; margin:20px 0;">
            <span style="font-weight:900; color:var(--p-green);">S/</span>
            <input type="number" id="valOffer" style="border:none; background:none; font-size:32px; font-weight:900; width:80%; outline:none;" placeholder="0.00">
        </div>
        <button onclick="submitOffer()" style="width:100%; background:var(--p-dark); color:white; border:none; padding:20px; border-radius:25px; font-weight:800;">ENVIAR PROPUESTA</button>
        <button onclick="closeModals()" style="width:100%; background:none; border:none; padding:15px; color:var(--p-slate); font-weight:700;">CANCELAR</button>
    </div>
</div>

<div class="overlay" id="modalMap">
    <div class="modal">
        <h2>Punto de Encuentro</h2>
        <div id="mapArea" style="width:100%; height:180px; background:#e2e8f0; border-radius:25px; margin:20px 0; display:flex; align-items:center; justify-content:center; flex-direction:column;">
            <span style="font-size:40px;">üìç</span>
            <b id="locText">Plaza de Armas - Huanta</b>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <button onclick="changeLoc('Mercado')" style="padding:10px; border-radius:15px; border:1px solid #ddd;">Mercado</button>
            <button onclick="changeLoc('Terminal')" style="padding:10px; border-radius:15px; border:1px solid #ddd;">Terminal</button>
        </div>
        <button onclick="submitMap()" style="width:100%; background:var(--p-green); color:white; border:none; padding:20px; border-radius:25px; margin-top:20px; font-weight:800;">CONFIRMAR LUGAR</button>
    </div>
</div>

<script>
    const DB_KEY = 'empire_v11_db';
    const ME = "Lider_Supremo";
    let CURRENT_PARTNER = "";
    let taps = 0;

    function boot() {
        renderInbox();
        setInterval(renderInbox, 3000);
        setInterval(renderMessages, 2000);
    }

    function navTo(p) {
        document.getElementById('appShell').className = 'app-shell pos-' + p;
        const btns = document.querySelectorAll('.dock-btn');
        btns.forEach((b, i) => b.className = (i+1 === p) ? 'dock-btn active' : 'dock-btn');
    }

    function adminTaps() {
        taps++;
        if(taps >= 7) {
            document.getElementById('adminConsole').style.display = 'block';
            document.getElementById('adminLog').innerText = JSON.stringify(JSON.parse(localStorage.getItem(DB_KEY) || '{}'), null, 2);
            taps = 0;
        }
        setTimeout(() => taps = 0, 3000);
    }

    // GESTI√ìN DE NEGOCIACIONES
    function renderInbox() {
        const db = JSON.parse(localStorage.getItem(DB_KEY) || '{}');
        const box = document.getElementById('inbox');
        const chats = Object.keys(db).filter(k => k.includes(ME));
        
        if(chats.length === 0) {
            box.innerHTML = `<div style="text-align:center; padding:40px; color:#cbd5e1;">Sin negocios activos.</div>`;
            return;
        }

        box.innerHTML = chats.map(k => {
            const partner = k.replace(ME, "").replace("_", "");
            const lastMsg = db[k][db[k].length - 1];
            return `
                <div class="biz-item" onclick="openChat('${partner}')">
                    <div style="width:55px; height:55px; background:var(--p-light); border-radius:15px; display:flex; align-items:center; justify-content:center; font-weight:800;">${partner[0].toUpperCase()}</div>
                    <div style="flex:1">
                        <b>${partner}</b><br>
                        <small style="color:var(--p-slate)">${lastMsg.t.substring(0,30)}...</small>
                    </div>
                    <span style="font-size:10px; opacity:0.5;">${lastMsg.h}</span>
                </div>
            `;
        }).join('');
    }

    function openChat(name) {
        CURRENT_PARTNER = name;
        document.getElementById('chatName').innerText = name;
        document.getElementById('chatAvatar').innerText = name[0].toUpperCase();
        navTo(2);
        renderMessages();
    }

    function renderMessages() {
        if(!CURRENT_PARTNER) return;
        const db = JSON.parse(localStorage.getItem(DB_KEY) || '{}');
        const key = [ME, CURRENT_PARTNER].sort().join('_');
        const msgs = db[key] || [];
        const flow = document.getElementById('msgFlow');

        const html = msgs.map(m => {
            let body = m.t;
            if(m.type === 'offer') body = `<div style="border:2px dashed white; padding:10px;">üí∞ OFERTA: S/ ${m.t}</div>`;
            if(m.type === 'map') body = `<div class="map-box">üìç <b>Lugar:</b> ${m.t}</div>`;
            if(m.type === 'invoice') body = `<div class="invoice-box">üßæ <b>INVOICE RANTIKUY</b><br>Monto: S/ ${m.t}<br>ID: #${Math.floor(Math.random()*9999)}</div>`;
            if(m.type === 'img') body = `<img src="${m.t}" style="width:100%; border-radius:15px;">`;

            return `<div class="bubble ${m.u === ME ? 'mine' : 'theirs'}">${body}<br><small style="font-size:8px; opacity:0.6;">${m.h}</small></div>`;
        }).join('');

        if(flow.innerHTML !== html) {
            flow.innerHTML = html;
            flow.scrollTop = flow.scrollHeight;
        }
    }

    function saveMsg(txt, type) {
        let db = JSON.parse(localStorage.getItem(DB_KEY) || '{}');
        const key = [ME, CURRENT_PARTNER].sort().join('_');
        if(!db[key]) db[key] = [];
        db[key].push({ u: ME, t: txt, type: type, h: new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}) });
        localStorage.setItem(DB_KEY, JSON.stringify(db));
        renderMessages();
    }

    function processMessage() {
        const input = document.getElementById('userInput');
        if(!input.value) return;
        saveMsg(input.value, 'text');
        input.value = "";
    }

    // BOTONES DE ACCI√ìN ACTIVADOS
    function sendOfferModal() { document.getElementById('modalOffer').style.display='flex'; }
    function submitOffer() {
        const val = document.getElementById('valOffer').value;
        if(val) saveMsg(val, 'offer');
        closeModals();
    }

    function sendMapModal() { document.getElementById('modalMap').style.display='flex'; }
    function changeLoc(l) { document.getElementById('locText').innerText = l + " - Huanta"; }
    function submitMap() {
        const loc = document.getElementById('locText').innerText;
        saveMsg(loc, 'map');
        closeModals();
    }

    function generateInvoice() {
        saveMsg("450.00", "invoice");
        confetti();
    }

    function closeModals() { document.querySelectorAll('.overlay').forEach(o => o.style.display='none'); }

    // BOTONES DEL DASHBOARD
    function openInventory() { alert("üì¶ Inventario Actual:\n- Cargamento Pro: 15u\n- Activos Huanta: 4u"); }
    function openReports() { alert("üìä Ganancia Proyectada: S/ 25,000\nROI: 45%\nSocio m√°s activo: El Merchant"); }
    function openCatalog() { alert("üè∑Ô∏è Cargando Cat√°logo de Huanta 2026..."); }
    function openMapGeneral() { alert("üìç Rastreo GPS: Todos los camiones est√°n en la Plaza Central."); }
    function openSecurityInfo() { alert("üõ°Ô∏è Protocolo Rantikuy: Encriptaci√≥n de Grado Militar AES-256 habilitada."); }
    function clearEmpireData() { if(confirm("¬øEliminar todos los registros del imperio?")) { localStorage.clear(); location.reload(); } }

    function pickFile() {
        let i = document.createElement('input'); i.type='file';
        i.onchange = e => {
            const f = e.target.files[0];
            const r = new FileReader();
            r.onload = ev => saveMsg(ev.target.result, f.type.includes('image') ? 'img' : 'text');
            r.readAsDataURL(f);
        };
        i.click();
    }

    window.onload = boot;
</script>
</body>
</html>
