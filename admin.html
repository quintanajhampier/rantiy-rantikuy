<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RR - Central de Comando Biom√©trica</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --vibrante: #22c55e; --oscuro: #0f172a;
            --huanta-light: #f0fdf4;
        }

        * { box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: #f8fafc; margin: 0; overflow: hidden; }

        /* --- PANTALLA DE SEGURIDAD BIOM√âTRICA --- */
        #auth-screen {
            position: fixed; inset: 0; background: var(--oscuro); z-index: 9999;
            display: flex; align-items: center; justify-content: center;
        }

        .auth-box {
            background: rgba(255,255,255,0.03); backdrop-filter: blur(20px);
            padding: 40px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.1);
            width: 90%; max-width: 400px; text-align: center; color: white;
        }

        .scanner-circle {
            width: 150px; height: 150px; border-radius: 50%; border: 3px solid var(--vibrante);
            margin: 0 auto 30px; display: flex; align-items: center; justify-content: center;
            position: relative; overflow: hidden; box-shadow: 0 0 30px rgba(34, 197, 94, 0.3);
        }

        .scan-line {
            position: absolute; width: 100%; height: 2px; background: var(--vibrante);
            box-shadow: 0 0 15px var(--vibrante); top: 0; animation: scan 2s infinite linear;
        }

        @keyframes scan { 0% { top: 0; } 100% { top: 100%; } }

        .biometric-btn {
            font-size: 50px; cursor: pointer; filter: drop-shadow(0 0 10px var(--vibrante));
        }

        input {
            width: 100%; padding: 18px; border-radius: 20px; border: none;
            background: rgba(255,255,255,0.1); color: white; font-weight: 700;
            text-align: center; margin-top: 20px; font-size: 16px;
        }

        /* --- PANEL INTERNO --- */
        #main-admin { display: none; height: 100vh; flex-direction: column; }
        .header-admin { background: white; padding: 25px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; }
        
        .card { background: white; margin: 20px; padding: 25px; border-radius: 35px; box-shadow: 0 15px 35px rgba(0,0,0,0.05); }
        .camera-box { width: 100%; height: 250px; background: #000; border-radius: 25px; overflow: hidden; position: relative; }
        video { width: 100%; height: 100%; object-fit: cover; }
        
        .btn-action { width: 100%; padding: 20px; border-radius: 20px; border: none; background: var(--vibrante); color: white; font-weight: 800; margin-top: 15px; cursor: pointer; }
    </style>
</head>
<body>

<div id="auth-screen">
    <div class="auth-box">
        <div id="auth-status" style="font-weight: 900; font-size: 20px; margin-bottom: 10px;">IDENTIDAD REQUERIDA</div>
        <p id="auth-desc" style="font-size: 12px; opacity: 0.6; margin-bottom: 25px;">Escanee su huella o rostro</p>
        
        <div class="scanner-circle">
            <div class="scan-line"></div>
            <div class="biometric-btn" id="bio-icon" onclick="startBiometricScan()">‚òùÔ∏è</div>
        </div>

        <div id="pass-area">
            <input type="password" id="master-key" placeholder="CLAVE MAESTRA">
            <button class="btn-action" onclick="firstTimeAuth()">VALIDAR ACCESO</button>
        </div>
    </div>
</div>

<div id="main-admin">
    <div class="header-admin">
        <div style="font-weight: 900; color: var(--oscuro);">MODO FUNDADOR</div>
        <button onclick="logout()" style="border:none; background:#fee2e2; color:#ef4444; padding:10px 15px; border-radius:12px; font-weight:800;">SALIR</button>
    </div>

    <div class="card">
        <h3 style="margin:0 0 15px 0;">üõ°Ô∏è Seguridad Facial</h3>
        <div class="camera-box">
            <video id="webcam" autoplay playsinline></video>
        </div>
        <button class="btn-action" onclick="activateCam()">INICIAR VIGILANCIA</button>
    </div>

    <div class="card">
        <h3 style="margin:0 0 15px 0;">üé® Color del Imperio</h3>
        <input type="color" id="empire-color" value="#22c55e" style="height:60px; padding:5px; cursor:pointer;">
        <button class="btn-action" style="background: var(--oscuro);" onclick="pushColor()">ENVIAR A TODOS LOS TERMINALES</button>
    </div>
</div>

<script>
    const CORRECT_KEY = "RR2026"; // Tu clave nivel medio

    // Verificar si ya est√° logueado "para siempre"
    window.onload = () => {
        if(localStorage.getItem('rr_auth') === 'true') {
            document.getElementById('auth-status').innerText = "BIENVENIDO FUNDADOR";
            document.getElementById('auth-desc').innerText = "Toque el sensor para confirmar";
            document.getElementById('pass-area').style.display = 'none';
        }
    }

    function startBiometricScan() {
        const icon = document.getElementById('bio-icon');
        icon.style.filter = "hue-rotate(90deg)";
        
        // Simulaci√≥n de escaneo de rostro/huella
        setTimeout(() => {
            if(localStorage.getItem('rr_auth') === 'true') {
                grantAccess();
            } else {
                alert("Primero debe validar su clave maestra una vez.");
            }
        }, 1500);
    }

    function firstTimeAuth() {
        const key = document.getElementById('master-key').value;
        if(key === CORRECT_KEY) {
            localStorage.setItem('rr_auth', 'true'); // Firma guardada para siempre
            alert("Identidad Vinculada Correctamente.");
            grantAccess();
        } else {
            alert("Clave incorrecta. Acceso bloqueado.");
        }
    }

    function grantAccess() {
        document.getElementById('auth-screen').style.display = 'none';
        document.getElementById('main-admin').style.display = 'flex';
        activateCam(); // Activa c√°mara autom√°ticamente al entrar
    }

    async function activateCam() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            document.getElementById('webcam').srcObject = stream;
        } catch (err) {
            console.log("C√°mara no disponible");
        }
    }

    function pushColor() {
        const col = document.getElementById('empire-color').value;
        localStorage.setItem('empire_theme', col);
        alert("Color aplicado al Imperio.");
    }

    function logout() {
        // No borramos rr_auth para que lo reconozca la pr√≥xima vez
        location.href = 'index.html';
    }
</script>
</body>
</html>
